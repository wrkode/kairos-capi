---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.17.0
  labels:
    cluster.x-k8s.io/provider: kairos
    cluster.x-k8s.io/v1beta2: v1beta2
  name: kairosconfigtemplates.bootstrap.cluster.x-k8s.io
spec:
  group: bootstrap.cluster.x-k8s.io
  names:
    categories:
    - cluster-api
    kind: KairosConfigTemplate
    listKind: KairosConfigTemplateList
    plural: kairosconfigtemplates
    singular: kairosconfigtemplate
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1beta2
    schema:
      openAPIV3Schema:
        description: KairosConfigTemplate is the Schema for the kairosconfigtemplates
          API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: KairosConfigTemplateSpec defines the desired state of KairosConfigTemplate
            properties:
              template:
                description: Template is the KairosConfig template to be used for
                  each Machine
                properties:
                  metadata:
                    description: Standard object's metadata.
                    type: object
                  spec:
                    description: Spec is the specification of the KairosConfig
                    properties:
                      caCertHashes:
                        description: CACertHashes are the CA certificate hashes for
                          secure join
                        items:
                          type: string
                        type: array
                      caCertSecretRef:
                        description: CACertSecretRef is a reference to a Secret containing
                          the CA certificate
                        properties:
                          apiVersion:
                            description: API version of the referent.
                            type: string
                          fieldPath:
                            description: |-
                              If referring to a piece of an object instead of an entire object, this string
                              should contain a valid JSON/Go field access statement, such as desiredState.manifest.containers[2].
                              For example, if the object reference is to a container within a pod, this would take on a value like:
                              "spec.containers{name}" (where "name" refers to the name of the container that triggered
                              the event) or if no container name is specified "spec.containers[2]" (container with
                              index 2 in this pod). This syntax is chosen only to have some well-defined way of
                              referencing a part of an object.
                            type: string
                          kind:
                            description: |-
                              Kind of the referent.
                              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
                            type: string
                          name:
                            description: |-
                              Name of the referent.
                              More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names
                            type: string
                          namespace:
                            description: |-
                              Namespace of the referent.
                              More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/
                            type: string
                          resourceVersion:
                            description: |-
                              Specific resourceVersion to which this reference is made, if any.
                              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#concurrency-control-and-consistency
                            type: string
                          uid:
                            description: |-
                              UID of the referent.
                              More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#uids
                            type: string
                        type: object
                        x-kubernetes-map-type: atomic
                      distribution:
                        default: k0s
                        description: |-
                          Distribution specifies the Kubernetes distribution to install
                          Currently only k0s is supported. k3s support is planned for future releases.
                        enum:
                        - k0s
                        type: string
                      files:
                        description: Files specifies additional files to include in
                          the cloud-config
                        items:
                          description: File represents a file to be written in the
                            cloud-config
                          properties:
                            content:
                              description: Content is the file content
                              type: string
                            owner:
                              description: Owner is the file owner (user:group format,
                                e.g., "root:root")
                              type: string
                            path:
                              description: Path is the absolute path where the file
                                should be written
                              type: string
                            permissions:
                              description: Permissions are the file permissions (octal
                                format, e.g., "0644")
                              type: string
                          required:
                          - content
                          - path
                          type: object
                        type: array
                      githubUser:
                        description: |-
                          GitHubUser is the GitHub username for SSH key access (e.g., "octocat")
                          If set, SSH keys will be fetched from GitHub
                        type: string
                      hostnamePrefix:
                        default: metal-
                        description: |-
                          HostnamePrefix is the prefix for the hostname that will be set on the node
                          The final hostname will be: {HostnamePrefix}{{ trunc 4 .MachineID }}
                          For example, if HostnamePrefix is "metal-", the hostname will be "metal-{4-char-machine-id}"
                          Defaults to "metal-" if not specified
                        type: string
                      install:
                        description: |-
                          Install specifies the Kairos installation configuration
                          This controls how Kairos OS is installed to disk
                        properties:
                          auto:
                            default: true
                            description: |-
                              Auto enables automatic installation to disk
                              When true, Kairos will automatically install to the specified device
                            type: boolean
                          device:
                            default: auto
                            description: |-
                              Device specifies the target device for installation
                              Use "auto" to automatically detect and use the first available disk
                              Or specify a device path like "/dev/sda" or "/dev/nvme0n1"
                            type: string
                          reboot:
                            default: true
                            description: |-
                              Reboot specifies whether to reboot after installation
                              When true, the system will reboot automatically after installation completes
                            type: boolean
                        type: object
                      kubernetesVersion:
                        description: KubernetesVersion specifies the Kubernetes version
                          to install
                        type: string
                      manifests:
                        description: |-
                          Manifests are Kubernetes manifests to be placed in /var/lib/k0s/manifests/
                          These will be automatically applied by k0s at cluster startup.
                          Each manifest is placed at /var/lib/k0s/manifests/{Name}/{File}
                        items:
                          description: |-
                            Manifest represents a Kubernetes manifest file to be deployed by k0s
                            The manifest will be placed at /var/lib/k0s/manifests/{Name}/{File} and automatically
                            applied by k0s when the cluster starts.
                          properties:
                            content:
                              description: Content is the manifest YAML content
                              type: string
                            file:
                              description: File is the filename within the Name directory
                              type: string
                            name:
                              description: |-
                                Name is the directory name under /var/lib/k0s/manifests/
                                This creates a directory structure: /var/lib/k0s/manifests/{Name}/{File}
                              type: string
                          required:
                          - content
                          - file
                          - name
                          type: object
                        type: array
                      pause:
                        description: Pause indicates that reconciliation should be
                          paused
                        type: boolean
                      postCommands:
                        description: PostCommands are commands to run after k0s/k3s
                          installation
                        items:
                          type: string
                        type: array
                      preCommands:
                        description: PreCommands are commands to run before k0s/k3s
                          installation
                        items:
                          type: string
                        type: array
                      role:
                        default: worker
                        description: Role indicates whether this is a control-plane
                          or worker node
                        enum:
                        - control-plane
                        - worker
                        type: string
                      serverAddress:
                        description: ServerAddress is the address of the Kubernetes
                          API server (for worker nodes)
                        type: string
                      singleNode:
                        description: |-
                          SingleNode indicates this is a single-node control plane cluster
                          When true, k0s will be configured with --single flag
                        type: boolean
                      sshPublicKey:
                        description: SSHPublicKey is a raw SSH public key (alternative
                          to GitHubUser)
                        type: string
                      token:
                        description: Token is the join token for worker nodes (if
                          required by distribution)
                        type: string
                      tokenSecretRef:
                        description: TokenSecretRef is a reference to a Secret containing
                          the join token
                        properties:
                          apiVersion:
                            description: API version of the referent.
                            type: string
                          fieldPath:
                            description: |-
                              If referring to a piece of an object instead of an entire object, this string
                              should contain a valid JSON/Go field access statement, such as desiredState.manifest.containers[2].
                              For example, if the object reference is to a container within a pod, this would take on a value like:
                              "spec.containers{name}" (where "name" refers to the name of the container that triggered
                              the event) or if no container name is specified "spec.containers[2]" (container with
                              index 2 in this pod). This syntax is chosen only to have some well-defined way of
                              referencing a part of an object.
                            type: string
                          kind:
                            description: |-
                              Kind of the referent.
                              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
                            type: string
                          name:
                            description: |-
                              Name of the referent.
                              More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names
                            type: string
                          namespace:
                            description: |-
                              Namespace of the referent.
                              More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/
                            type: string
                          resourceVersion:
                            description: |-
                              Specific resourceVersion to which this reference is made, if any.
                              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#concurrency-control-and-consistency
                            type: string
                          uid:
                            description: |-
                              UID of the referent.
                              More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#uids
                            type: string
                        type: object
                        x-kubernetes-map-type: atomic
                      userGroups:
                        default:
                        - admin
                        description: UserGroups are the groups for the default user
                        items:
                          type: string
                        type: array
                      userName:
                        default: kairos
                        description: UserName is the username for the default user
                        type: string
                      userPassword:
                        default: kairos
                        description: |-
                          UserPassword is the password for the default user
                          Defaults to "kairos" if not specified.
                          WARNING: This default is for development only and is NOT production-safe.
                          For production use, always set a strong password.
                        type: string
                      workerToken:
                        description: |-
                          WorkerToken is the join token for worker nodes (inline specification)
                          For production use, prefer WorkerTokenSecretRef instead.
                          If both WorkerToken and WorkerTokenSecretRef are set, WorkerTokenSecretRef takes precedence.
                        type: string
                      workerTokenSecretRef:
                        description: |-
                          WorkerTokenSecretRef is a reference to a Secret containing the worker join token
                          This is the recommended way to provide worker tokens for security.
                          The Secret must contain a key specified by WorkerTokenSecretRef.Key (defaults to "token").
                        properties:
                          key:
                            default: token
                            description: |-
                              Key is the key within the Secret that contains the token
                              Defaults to "token" if not specified
                            type: string
                          name:
                            description: Name is the name of the Secret
                            type: string
                          namespace:
                            description: |-
                              Namespace is the namespace of the Secret
                              If not specified, defaults to the same namespace as the KairosConfig
                            type: string
                        required:
                        - name
                        type: object
                    required:
                    - kubernetesVersion
                    type: object
                required:
                - spec
                type: object
            required:
            - template
            type: object
        type: object
    served: true
    storage: true
    subresources: {}
